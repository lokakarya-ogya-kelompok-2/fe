<div class="flex justify-content-center">
  <div style="max-width: 600px; width: 100%">
    <form #userForm="ngForm" (submit)="onSubmit()">
      <div class="grid pt-4">
        <!-- Full Name -->
        <div class="col-12 mb-4">
          <p-floatLabel>
            <input
              pInputText
              type="text"
              name="fullName"
              id="fullName"
              [(ngModel)]="formData.full_name"
              required
              class="w-full"
            />
            <label for="fullName">Full Name</label>
          </p-floatLabel>
        </div>

        <!-- Position -->
        <div class="col-12 mb-4">
          <p-floatLabel>
            <input
              pInputText
              type="text"
              name="position"
              id="position"
              [(ngModel)]="formData.position"
              required
              class="w-full"
            />
            <label for="position">Position</label>
          </p-floatLabel>
        </div>

        <!-- Username -->
        <div class="col-12 mb-4">
          <p-floatLabel>
            <input
              pInputText
              type="text"
              name="username"
              id="username"
              [(ngModel)]="formData.username"
              required
              class="w-full"
            />
            <label for="username">Username</label>
          </p-floatLabel>
        </div>

        <!-- Email -->
        <div class="col-12 mb-4">
          <p-floatLabel>
            <input
              pInputText
              type="email"
              name="email"
              id="email"
              [(ngModel)]="formData.email"
              required
              class="w-full"
              email
            />
            <label for="email">Email</label>
          </p-floatLabel>
        </div>

        @if (formData.id === null) {
        <!-- Password -->
        <div class="col-12 mb-4">
          <p-floatLabel>
            <p-password
              [(ngModel)]="formData.password"
              minlength="8"
              maxlength="32"
              name="password"
              id="password"
              styleClass="w-full"
              inputStyleClass="w-full"
            />
            <label for="password">Password</label>
          </p-floatLabel>
        </div>
        }

        <!-- Division -->
        <div class="col-12 mb-4">
          <p-floatLabel>
            <p-dropdown
              name="division"
              [options]="divisions"
              [(ngModel)]="formData.division_id"
              optionLabel="division_name"
              optionValue="id"
              placeholder="Select a division"
              [loading]="isDivisionLoading"
              required
              styleClass="w-full"
            />
            <label for="division">Division</label>
          </p-floatLabel>
        </div>

        <!-- Roles -->
        <div class="col-12 mb-4">
          <p-floatLabel>
            <p-multiSelect
              [options]="roles"
              [(ngModel)]="formData.roles"
              optionLabel="role_name"
              optionValue="id"
              placeholder="Select Roles"
              name="roles"
              id="roles"
              styleClass="w-full"
              required
            />
            <label for="role">Roles</label>
          </p-floatLabel>
        </div>

        <!-- Join Date -->
        <div class="col-12 mb-4">
          <label for="joinDate">Join Date</label>
          <p-calendar
            inline="true"
            [(ngModel)]="formData.join_date"
            inputId="joinDate"
            name="joinDate"
            styleClass="w-full"
            [maxDate]="maxDate"
            required
          />
        </div>

        <!-- Combined Employment Status and Enabled Toggle -->
        <div class="col-12 mb-4">
          <div class="flex justify-content-around align-items-center">
            <div>
              <label class="block mb-2">Employment Status</label>
              <p-selectButton
                [options]="statusOptions"
                [(ngModel)]="formData.employee_status"
                name="status"
                optionLabel="label"
                optionValue="value"
                required
              ></p-selectButton>
            </div>
            <div>
              <label for="enabled" class="block mb-2">Enabled</label>
              <p-toggleButton
                [(ngModel)]="formData.enabled"
                onLabel="Enabled"
                offLabel="Disabled"
                name="enabled"
                id="enabled"
                required
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Submit and Cancel Buttons -->
      <div class="flex justify-content-center gap-2 mt-4">
        <p-button
          label="Cancel"
          icon="pi pi-times"
          severity="secondary"
          (onClick)="onCancel.emit()"
        />
        <p-button
          label="Save"
          icon="pi pi-save"
          [loading]="submitBtnLoading"
          [disabled]="userForm.invalid"
          type="submit"
        />
      </div>
    </form>
  </div>
</div>
