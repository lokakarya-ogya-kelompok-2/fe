<!-- <p>Welcome {{ username }}</p> -->

<!-- @if (username) { -->

<div class="center">
  <div
    style="
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    "
  >
    <h1>Welcome, {{ fullName }}</h1>
    <ng-template pTemplate="end" style="display: inline"> </ng-template>
    <div class="card">
      <p-megaMenu
        [model]="items"
        [style]="{ 'border-radius': '1rem', display: 'flex', }"
        styleClass="p-4 surface-0"
      >
        <ng-template pTemplate="item" let-item>
          <a
            *ngIf="item.root"
            pRipple
            class="flex align-items-center cursor-pointer px-3 py-2 overflow-hidden relative font-semibold text-lg uppercase"
            style="border-radius: 2rem; border: 3px"
          >
            <i [ngClass]="item.icon"></i>
            <span class="ml-2">{{ item.label }}</span>
          </a>
        </ng-template>
        <!-- <ng-template pTemplate="start" style="display: flex">
          <p-avatar
            image="https://primefaces.org/cdn/primeng/images/demo/avatar/walter.jpg"
            shape="circle"
          />
        </ng-template> -->
      </p-megaMenu>
    </div>

    <!-- <p-button label="Change Password" (onClick)="dialogVisible = true" />
    <p-button label="Main menu" severity="success" [routerLink]="'/manage'" />
    <p-button
      label="Logout"
      severity="danger"
      (onClick)="authService.logout()"
    /> -->
  </div>
</div>

<p-dialog
  [(visible)]="dialogVisible"
  [modal]="true"
  header="Change Password"
  styleClass="w-full sm:w-10 md:w-8 lg:w-6"
  [style]="{ width: '500px' }"
>
  <form
    (submit)="onChangePasswordSubmit()"
    #changePasswordForm="ngForm"
    class="p-fluid"
  >
    <div class="flex flex-column gap-4 mt-4">
      <!-- Current password - full width -->
      <div class="field w-full">
        <p-floatLabel>
          <p-password
            id="current_password"
            class="w-full"
            placeholder="Enter your current password"
            feedback="false"
            name="current_password"
            minlength="8"
            maxlength="32"
            required
            [(ngModel)]="formData.current_password"
          />
          <label for="current_password">Current Password</label>
        </p-floatLabel>
      </div>

      <!-- New passwords container - side by side -->
      <div class="flex gap-3">
        <div class="field w-8">
          <p-floatLabel>
            <p-password
              id="new_password"
              class="w-full"
              placeholder="Enter your new password"
              name="new_password"
              minlength="8"
              maxlength="32"
              required
              [(ngModel)]="formData.new_password"
            />
            <label for="new_password">New Password</label>
          </p-floatLabel>
        </div>

        <div class="field w-8">
          <p-floatLabel>
            <p-password
              id="confirm_password"
              class="w-full"
              placeholder="Re-enter your new password"
              feedback="false"
              name="confirm_password"
              minlength="8"
              maxlength="32"
              required
              [(ngModel)]="formData.confirm_new_password"
            />
            <label for="confirm_password">Confirm New Password</label>
          </p-floatLabel>
        </div>
      </div>
      @if(newPasswordAndConfirmMissmatch() ||
      newPasswordAndCurrentPasswordIsTheSame()) {
      <p-message
        severity="error"
        [text]="
          newPasswordAndConfirmMissmatch()
            ? 'New password and confirmation password do not match'
            : newPasswordAndCurrentPasswordIsTheSame()
            ? 'New password and current password is the same'
            : ''
        "
        styleClass="w-full"
      ></p-message>
      }
      <div class="flex justify-content-end gap-2 mt-4">
        <p-button
          label="Cancel"
          (click)="dialogVisible = false; resetFormData()"
          styleClass="p-button-text"
        ></p-button>
        <p-button
          type="submit"
          label="Change Password"
          [disabled]="
            changePasswordForm.invalid ||
            newPasswordAndConfirmMissmatch() ||
            newPasswordAndCurrentPasswordIsTheSame()
          "
          [loading]="isChangePasswordBtnLoading"
        />
      </div>
    </div>
  </form>
</p-dialog>
<!-- } @else { -->
<!-- <div class="center">
  <H1 style="margin-right: 24px">Please log in ==> </H1>
  <p-button label="Login" routerLink="/login" severity="primary" />
</div> -->
<!-- } -->
